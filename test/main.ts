import './style.css';
import { PolygonController, PolylineController, MarkerController, MapPlugin, MapController } from '../src/index.js';
import { Chart } from 'chart.js';

import 'chart.js/auto';
let testData = {
  datasets: [
    {
      type: "polyline", label: "Transatlantic", data: [
        [37.772, -122.214],
        [21.291, -157.821],
        [-18.142, 178.431],
        [-27.467, 153.027]]
    },
    { label: "UK", type: "marker", data: [40.7128, -74.0060] },
    { type: "marker", data: [51.5074, -0.1278] },
    { type: "marker", data: [35.6762, 139.6503] },
    { label: "Test 1", type: "marker", data: [[35.6762, 139.6503], [35.4762, 139.7503]] },
    { type: "marker", data: [48.8566, 2.3522] },
    { type: "marker", data: [-33.8688, 151.2093] },
    {
      label: "Alaska",
      borderColor: "#00FFaa",
      backgroundColor: "#00FF00",
      "type": "polygon" as const,
      "data": [
        [
          70.0187,
          -141.0205
        ],
        [
          70.1292,
          -141.7291
        ],
        [
          70.4515,
          -144.8163
        ],
        [
          70.7471,
          -148.4583
        ],
        [
          70.7923,
          -151.1609
        ],
        [
          71.147,
          -152.6221
        ],
        [
          71.1185,
          -153.9954
        ],
        [
          71.4307,
          -154.8853
        ],
        [
          71.5232,
          -156.7529
        ],
        [
          71.2796,
          -157.9449
        ],
        [
          71.2249,
          -159.6313
        ],
        [
          70.6363,
          -161.8671
        ],
        [
          70.0843,
          -163.5809
        ],
        [
          69.3028,
          -165.2399
        ],
        [
          69.1782,
          -166.8768
        ],
        [
          68.3344,
          -168.0414
        ],
        [
          67.6844,
          -165.9155
        ],
        [
          67.2933,
          -164.6082
        ],
        [
          66.7789,
          -164.0149
        ],
        [
          66.581,
          -165.7507
        ],
        [
          66.2867,
          -167.5745
        ],
        [
          66.0269,
          -168.9862
        ],
        [
          65.497,
          -168.9478
        ],
        [
          65.042,
          -167.4756
        ],
        [
          64.3922,
          -167.0142
        ],
        [
          64.0554,
          -165.7343
        ],
        [
          64.0193,
          -163.2294
        ],
        [
          63.9615,
          -162.1143
        ],
        [
          63.6877,
          -163.6029
        ],
        [
          63.453,
          -165.3717
        ],
        [
          62.4133,
          -166.3715
        ],
        [
          61.6534,
          -166.9867
        ],
        [
          60.8556,
          -166.4429
        ],
        [
          60.5357,
          -167.8381
        ],
        [
          59.5482,
          -167.7118
        ],
        [
          59.4115,
          -165.8002
        ],
        [
          59.3696,
          -164.5972
        ],
        [
          59.1168,
          -162.8558
        ],
        [
          58.1185,
          -162.5427
        ],
        [
          58.1359,
          -160.6421
        ],
        [
          58.0285,
          -159.505
        ],
        [
          57.6336,
          -158.8953
        ],
        [
          56.909,
          -159.906
        ],
        [
          56.3926,
          -160.6531
        ],
        [
          56.2342,
          -161.8835
        ],
        [
          55.724,
          -162.9822
        ],
        [
          55.2478,
          -164.3994
        ],
        [
          54.7753,
          -165.3168
        ],
        [
          54.1463,
          -167.1075
        ],
        [
          53.5632,
          -168.5852
        ],
        [
          53.1402,
          -169.9146
        ],
        [
          52.5964,
          -169.5959
        ],
        [
          52.9089,
          -168.2227
        ],
        [
          54.2139,
          -162.7734
        ],
        [
          54.6786,
          -159.1452
        ],
        [
          55.6567,
          -155.4634
        ],
        [
          57.351,
          -152.14
        ],
        [
          59.2209,
          -150.8203
        ],
        [
          59.7695,
          -147.4461
        ],
        [
          60.3521,
          -145.985
        ],
        [
          59.8917,
          -144.1544
        ],
        [
          59.8172,
          -141.6811
        ],
        [
          59.5225,
          -140.5124
        ],
        [
          59.0292,
          -138.8548
        ],
        [
          57.9032,
          -136.8526
        ],
        [
          56.9157,
          -136.0725
        ],
        [
          56.1555,
          -134.9794
        ],
        [
          55.3237,
          -134.0057
        ],
        [
          54.6341,
          -133.6418
        ],
        [
          54.7135,
          -130.6261
        ],
        [
          55.2869,
          -129.993
        ],
        [
          55.9869,
          -130.0108
        ],
        [
          56.1057,
          -130.1083
        ],
        [
          56.6086,
          -131.5887
        ],
        [
          57.8404,
          -132.8755
        ],
        [
          58.7276,
          -133.8423
        ],
        [
          59.3108,
          -134.9121
        ],
        [
          59.802,
          -135.4724
        ],
        [
          59.6039,
          -136.3445
        ],
        [
          59.1619,
          -136.8251
        ],
        [
          59.2441,
          -137.6079
        ],
        [
          60.0902,
          -139.2119
        ],
        [
          60.3575,
          -139.0938
        ],
        [
          60.1866,
          -140.0056
        ],
        [
          60.3059,
          -140.9999
        ],
        [
          70.0187,
          -141.0205
        ]
      ]
    },
    {
      label: "Alabama",
      borderColor: "#00FFaa",
      backgroundColor: "#00FF00",
      "type": "polygon" as const,
      "data": [
        [
          35.0041,
          -88.1955
        ],
        [
          34.9918,
          -85.6068
        ],
        [
          32.8404,
          -85.1756
        ],
        [
          32.2593,
          -84.8927
        ],
        [
          32.1535,
          -85.0342
        ],
        [
          31.7947,
          -85.1358
        ],
        [
          31.52,
          -85.0438
        ],
        [
          31.3384,
          -85.0836
        ],
        [
          31.2093,
          -85.107
        ],
        [
          31.0023,
          -84.9944
        ],
        [
          30.9953,
          -87.6009
        ],
        [
          30.9423,
          -87.5926
        ],
        [
          30.8539,
          -87.6256
        ],
        [
          30.6745,
          -87.4072
        ],
        [
          30.4404,
          -87.3688
        ],
        [
          30.1463,
          -87.524
        ],
        [
          30.1546,
          -88.3864
        ],
        [
          31.8939,
          -88.4743
        ],
        [
          34.8938,
          -88.1021
        ],
        [
          34.9479,
          -88.1721
        ],
        [
          34.9107,
          -88.1461
        ]
      ]
    },
    {
      label: "Arkansas",
      borderColor: "#00FFaa",
      backgroundColor: "#00FF00",
      "type": "polygon" as const,
      "data": [
        [
          33.0225,
          -94.0416
        ],
        [
          33.0075,
          -91.2057
        ],
        [
          33.118,
          -91.1989
        ],
        [
          33.1824,
          -91.1041
        ],
        [
          33.3053,
          -91.1343
        ],
        [
          33.4211,
          -91.1646
        ],
        [
          33.4337,
          -91.2263
        ],
        [
          33.5403,
          -91.2524
        ],
        [
          33.6112,
          -91.1797
        ],
        [
          33.6855,
          -91.2524
        ],
        [
          33.6946,
          -91.1261
        ],
        [
          33.7883,
          -91.1412
        ],
        [
          33.77,
          -91.0451
        ],
        [
          33.8328,
          -91.0341
        ],
        [
          33.9399,
          -91.0863
        ],
        [
          34.0208,
          -90.9256
        ],
        [
          34.0856,
          -90.9036
        ],
        [
          34.1345,
          -90.9586
        ],
        [
          34.1675,
          -90.9132
        ],
        [
          34.138,
          -90.8501
        ],
        [
          34.2311,
          -90.9325
        ],
        [
          34.3446,
          -90.6935
        ],
        [
          34.4409,
          -90.5603
        ],
        [
          34.5348,
          -90.5548
        ],
        [
          34.5959,
          -90.5768
        ],
        [
          34.7213,
          -90.5301
        ],
        [
          34.7574,
          -90.5328
        ],
        [
          34.878,
          -90.4546
        ],
        [
          34.8454,
          -90.3529
        ],
        [
          34.869,
          -90.2911
        ],
        [
          35.0255,
          -90.3104
        ],
        [
          35.1154,
          -90.2843
        ],
        [
          35.1323,
          -90.1772
        ],
        [
          35.1985,
          -90.1112
        ],
        [
          35.2826,
          -90.1524
        ],
        [
          35.4383,
          -90.1332
        ],
        [
          35.5579,
          -90.0206
        ],
        [
          35.674,
          -89.978
        ],
        [
          35.7287,
          -89.9547
        ],
        [
          35.9169,
          -89.6594
        ],
        [
          35.9658,
          -89.6883
        ],
        [
          36.0013,
          -89.713
        ],
        [
          35.9958,
          -90.3735
        ],
        [
          36.1268,
          -90.2664
        ],
        [
          36.2875,
          -90.0934
        ],
        [
          36.3892,
          -90.0742
        ],
        [
          36.418,
          -90.1511
        ],
        [
          36.4997,
          -90.1566
        ],
        [
          36.4986,
          -94.6198
        ],
        [
          35.3801,
          -94.4412
        ],
        [
          33.6318,
          -94.4893
        ],
        [
          33.6421,
          -94.4522
        ],
        [
          33.5597,
          -94.4
        ],
        [
          33.5883,
          -94.2462
        ],
        [
          33.5872,
          -94.1885
        ],
        [
          33.5345,
          -94.0375
        ],
        [
          33.4314,
          -94.043
        ],
        [
          33.0213,
          -94.043
        ]
      ]
    }
  ]
};

Chart.register(PolylineController, MarkerController, PolygonController, MapController);

// Wait for DOM to be ready
document.addEventListener('DOMContentLoaded', () => {

  // Create and setup canvas
  const canvas = document.getElementById('canvas') as HTMLCanvasElement;
  if (!canvas) return;

  // Load Google Maps API
  const script = document.createElement('script');
  const API_KEY = "AIzaSyDqUZ6lVdQA-9iBpfI1q4mSCH9seg2E-7M";
  script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&apiOptions=MCYJ5E517XR2JC`;
  script.async = true;
  script.defer = true;

  script.onload = () => {
    // Create chart
    new Chart(canvas, {
      type: 'map',
      data: testData as any,
      plugins: [MapPlugin],
      options: {
        plugins: {
          title: {
            display: true,
            text: 'Test Map'
          }
        },
        layout: {
          padding: 10
        },
        responsive: true,
        maintainAspectRatio: false
      }
    });
  };

  document.head.appendChild(script);
});